<div class="container">
  <h1>{{ title }}</h1>

  <form (submit)="$event.preventDefault(); addItem(taskInput)">
    <input #taskInput type="text" placeholder="What would you like to add?" maxlength="200" required />
    <button type="submit">Add</button>
  </form>

  @if (loading()) {
  <p>Loading...</p>
  }

  @if (error()) {
  <p class="error">{{ error() }}</p>
  }

  <ul class="todo-list">
    @for (t of todos(); track t.id) {
    <li class="todo-item" [class.completed]="t.isCompleted">
      <!-- Completion toggle -->
      <div class="circle" (click)="toggleComplete(t)" [class.filled]="t.isCompleted"></div>

      <!-- Expandable text -->
      <div class="text" (click)="toggleExpand(t)" [class.expanded]="t.expanded">
        <span>{{ t.name }}</span>
        <small>— {{ t.createdAt | date:'short' }}</small>
      </div>

      <!-- Delete button -->
      <button class="delete-btn" (click)="removeItem(t.id!)">×</button>
    </li>
    }
  </ul>


  @if (!loading() && todos().length === 0) {
  <p>No items yet.</p>
  }
</div>

<style>
  .container {
    max-width: 640px;
    margin: 2rem auto;
    font-family: system-ui, sans-serif;
  }

  form {
    display: flex;
    gap: .5rem;
    margin-bottom: 1rem;
  }

  input {
    flex: 1;
    padding: .5rem;
  }

  button {
    padding: .5rem .75rem;
  }

  ul {
    list-style: none;
    padding: 0;
    display: grid;
    gap: .5rem;
  }

  li {
    display: flex;
    align-items: center;
    gap: .5rem;
  }

  .error {
    color: #b00020;
  }
</style>